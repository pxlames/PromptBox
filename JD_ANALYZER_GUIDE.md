# JD解析功能使用指南

## 功能概述

本系统新增了使用大模型自动解析JD（岗位要求）的功能。用户可以通过AI快速拆解JD内容，并支持自定义系统提示词来调整解析方式。

## 核心功能

### 1. AI自动拆解JD
- 点击JD列表中的"拆解"按钮
- 在弹出的拆解管理对话框中，点击"🤖 使用AI拆解"按钮
- 系统会自动调用大模型分析JD内容并生成结构化拆解结果

### 2. 自定义系统提示词
- 系统提供默认的系统提示词，用于指导AI如何拆解JD
- 用户可以输入自定义系统提示词来调整解析逻辑
- 系统提示词支持以下内容：
  - 岗位职责分析
  - 岗位要求分析
  - 加分项分析
  - 岗位评估
  - 匹配建议

### 3. 拆解结果管理
- 拆解结果会自动保存
- 支持查看、编辑、删除拆解记录
- 支持Markdown格式渲染
- 可以多次解析，生成多个拆解版本

## 使用步骤

### 基本使用流程

1. **添加JD信息**
   - 进入"岗位要求"标签页
   - 点击"新增岗位要求"
   - 填写公司名称、岗位名称和文字描述
   - 可以上传JD图片（可选）
   - 点击"提交"

2. **使用AI拆解JD**
   - 在JD列表中，找到要拆解的JD
   - 点击"拆解"按钮
   - 在拆解管理对话框中，点击"🤖 使用AI拆解"
   - （可选）如果需要自定义解析方式，输入系统提示词
   - 点击"开始AI拆解"
   - 等待几秒钟，系统会自动生成拆解结果

3. **查看和编辑拆解结果**
   - 拆解结果会显示在左侧列表中
   - 点击"编辑"可以修改拆解内容
   - 点击"删除"可以删除拆解记录
   - 右侧表单可以手动输入新的拆解内容

## 系统配置

### API配置

系统使用SILICONFLOW API进行大模型调用，配置在 `backend/config.yaml` 文件中：

```yaml
siliconflow:
  api_key: sk-mfvgxdishgetqlikzayseblbqwbgbfhnmzxybxlnedrfafwy
  base_url: https://api.siliconflow.cn/v1
  model: Qwen/Qwen2.5-72B-Instruct
```

### 默认系统提示词

系统内置了默认的系统提示词，引导AI按照以下结构拆解JD：

1. **岗位职责分析**
   - 列出所有核心职责
   - 分析职责的重要性和优先级
   - 提炼关键能力要求

2. **岗位要求分析**
   - 技能要求（编程语言、框架、工具等）
   - 学历和经验要求
   - 软技能要求（沟通能力、团队协作等）

3. **加分项分析**
   - 列出额外的加分项目
   - 评估加分项对岗位匹配度的提升

4. **岗位评估**
   - 岗位难度评估（1-5星）
   - 待遇可能的行业水平
   - 适合的候选人类别

5. **匹配建议**
   - 如何针对该JD准备简历
   - 需要强调的技能和经验
   - 可能的面试重点

## 注意事项

1. **JD必须有文字描述**
   - AI拆解功能需要JD有文字描述
   - 如果JD只有图片没有文字描述，无法使用AI拆解

2. **网络连接**
   - AI拆解需要调用在线API
   - 确保服务器能够访问 https://api.siliconflow.cn

3. **响应时间**
   - AI拆解可能需要几秒到几十秒
   - 请耐心等待，不要重复点击

4. **系统提示词**
   - 系统提示词是可选的
   - 留空则使用默认提示词
   - 自定义提示词需要清晰明确

## 技术实现

### 后端

- **新增文件**: `backend/app/llm_service.py`
  - 封装SILICONFLOW API调用
  - 提供 `breakdown_jd()` 方法

- **更新文件**: `backend/app/routes.py`
  - 新增 `/resume/jd-breakdowns/analyze` 接口
  - 支持自定义系统提示词

### 前端

- **更新文件**: `frontend/src/components/ResumeManager.vue`
  - 新增AI拆解按钮
  - 新增系统提示词编辑器
  - 集成AI拆解功能

- **更新文件**: `frontend/src/api.ts`
  - 新增 `analyzeJd()` 方法

## API参考

### 拆解JD接口

**POST** `/api/resume/jd-breakdowns/analyze`

**请求体**:
```json
{
  "jd_id": 1,
  "system_prompt": "自定义系统提示词（可选）"
}
```

**响应**:
```json
{
  "id": 1,
  "jd_id": 1,
  "company": "公司名称",
  "position": "岗位名称",
  "breakdown_content": "拆解内容（Markdown格式）",
  "created_at": "2024-01-01T00:00:00",
  "updated_at": "2024-01-01T00:00:00"
}
```

## 常见问题

**Q: 为什么AI拆解失败？**
A: 请检查以下几点：
1. JD是否有文字描述
2. 网络连接是否正常
3. API密钥是否有效
4. 服务器能否访问API

**Q: 可以修改系统提示词吗？**
A: 可以。在"使用AI拆解"界面中，可以输入自定义系统提示词来调整解析逻辑。

**Q: 拆解结果可以编辑吗？**
A: 可以。拆解结果会显示在列表中，点击"编辑"按钮即可修改。

**Q: 支持多次拆解同一个JD吗？**
A: 支持。每次拆解都会创建一个新的拆解记录。

## 开发计划

- [ ] 支持图片OCR识别（自动提取JD图片中的文字）
- [ ] 支持批量拆解
- [ ] 支持导出拆解结果为PDF
- [ ] 支持自定义拆解模板
- [ ] 增加更多大模型支持（可切换不同的模型）

